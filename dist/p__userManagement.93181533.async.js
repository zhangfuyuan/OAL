(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[17],{"/2/m":function(e,a,t){e.exports={myPageHeaderWrapper:"antd-pro-pages-user-management-style-myPageHeaderWrapper",tableList:"antd-pro-pages-user-management-style-tableList",tableListOperator:"antd-pro-pages-user-management-style-tableListOperator",tableListForm:"antd-pro-pages-user-management-style-tableListForm",submitButtons:"antd-pro-pages-user-management-style-submitButtons",card:"antd-pro-pages-user-management-style-card"}},"4e7l":function(e,a,t){"use strict";var n=t("g09b");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("2qtc");var l=n(t("kLXV"));t("y8nQ");var s=n(t("Vl3Y"));t("5NDa");var r=n(t("5rEg")),o=n(t("q1tI")),i=t("Y2fQ"),d={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},u=function(e){var a=e.form,t=e.visible,n=e.bean,u=void 0===n?{}:n,m=e.currentUserAuthorizedPoints,c=m.terminalTotal,f=void 0===c?0:c,g=m.terminalAssigned,p=void 0===g?0:g,b=e.handleCancel,h=e.handleSubmit,M=e.confirmLoading,v=u.authorizedPoints||{},E=v.terminalTotal,y=void 0===E?0:E,L=v.terminalAssigned,S=void 0===L?0:L,k=a.getFieldDecorator,U=function(){a.validateFields(function(e,a){e||h({userId:u._id,points:parseInt(a.points)||0,diff:parseInt(a.points)-y||0})})},x=function(e){return"0"===e?"0":(e&&e.replace&&parseInt(e.replace(/[^\d]/g,""))||"")+""},A=function(e,a,t){if(a&&a.replace){var n=parseInt(a.replace(/[^\d]/g,""));n<S?t((0,i.formatMessage)({id:"oal.user-manage.totalNotLessAssign"})):n>f-p+y&&t((0,i.formatMessage)({id:"oal.common.insufficientPoints"}))}t()};return o.default.createElement(l.default,{destroyOnClose:!0,title:"".concat((0,i.formatMessage)({id:"oal.common.assignTo"})," ").concat(u&&u.userName||"-"),visible:t,onOk:U,onCancel:b,confirmLoading:M,maskClosable:!1},o.default.createElement("div",{style:{textAlign:"center",marginBottom:"20px"}},o.default.createElement("span",null,o.default.createElement("span",{style:{color:"rgba(0, 0, 0, 0.85)"}},o.default.createElement(i.FormattedMessage,{id:"oal.common.myAvailablePoints"})," :"),o.default.createElement("span",{style:{margin:"0 50px 0 10px"}},f-p||0)),o.default.createElement("span",null,o.default.createElement("span",{style:{color:"rgba(0, 0, 0, 0.85)"}},o.default.createElement(i.FormattedMessage,{id:"oal.user-manage.agentPoints"})," :"),o.default.createElement("span",{style:{margin:"0 50px 0 10px"}},S||0,"/",y||0))),o.default.createElement(s.default,d,o.default.createElement(s.default.Item,{label:(0,i.formatMessage)({id:"oal.user-manage.agentTotalPoints"})},k("points",{rules:[{required:!0,message:(0,i.formatMessage)({id:"oal.common.pleaseEnter"})},{validator:A}],normalize:x,initialValue:(y||0)+""})(o.default.createElement(r.default,{autoFocus:!0,placeholder:(0,i.formatMessage)({id:"oal.user-manage.agentTotalPoints"})})))))},m=s.default.create({name:"assignModal"})(u),c=m;a.default=c},AInq:function(e,a,t){"use strict";var n=t("g09b"),l=t("tAuX");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("IzEo");var s=n(t("bx4M"));t("14J3");var r=n(t("BMrR"));t("+L6B");var o=n(t("2/Rp"));t("jCWc");var i=n(t("kPKH"));t("5NDa");var d=n(t("5rEg")),u=n(t("p0pE"));t("miYZ");var m=n(t("tsqr"));t("/zsF");var c=n(t("PArb"));t("5Dmo");var f=n(t("3S7+")),g=n(t("2Taf")),p=n(t("vZ4D")),b=n(t("l4Ni")),h=n(t("ujKo")),M=n(t("MhPg"));t("OaEy");var v=n(t("2fM7"));t("y8nQ");var E=n(t("Vl3Y"));t("2qtc");var y,L,S,k=n(t("kLXV")),U=l(t("q1tI")),x=t("Hx5s"),A=t("MuoO"),P=(n(t("wd/R")),n(t("3a4m")),t("LvDl"),n(t("Ivs8"))),C=n(t("HGS4")),w=n(t("TIwi")),V=n(t("G4ee")),F=n(t("4e7l")),N=n(t("/2/m")),I=t("Y2fQ");n(t("wY1l"));function T(e){return function(){var a,t=(0,h.default)(e);if(O()){var n=(0,h.default)(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return(0,b.default)(this,a)}}function O(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}k.default.confirm;var R=E.default.Item,_=(v.default.Option,y=(0,A.connect)(function(e){var a=e.user.currentUser,t=e.userManagement,n=e.loading;return{currentUser:a,userManagement:t,userListLoading:n.effects["userManagement/fetch"],addLoading:n.effects["userManagement/add"],modifyLoading:n.effects["userManagement/modify"],handleStateLoading:n.effects["userManagement/handleState"],resetPswLoading:n.effects["userManagement/resetPsw"],assignLoading:n.effects["userManagement/assign"]}}),y((S=function(e){(0,M.default)(t,e);var a=T(t);function t(){var e;(0,g.default)(this,t);for(var n=arguments.length,l=new Array(n),s=0;s<n;s++)l[s]=arguments[s];return e=a.call.apply(a,[this].concat(l)),e.state={modalVisible:!1,resetVisible:!1,delVisible:!1,assignVisible:!1,formValues:{},selectedRows:[],selectedUser:{},page:{current:1,pageSize:10}},e.columns=function(){return[{title:(0,I.formatMessage)({id:"oal.user-manage.accountName"}),dataIndex:"userName",key:"userName",render:function(e,a){return U.default.createElement("span",null,a&&a.userName||"-")}},{title:(0,I.formatMessage)({id:"oal.common.nickname"}),key:"nickname",dataIndex:"nickname",render:function(e,a){return U.default.createElement("span",null,a&&a.profile&&a.profile.nickName||"-")}},{title:(0,I.formatMessage)({id:"oal.common.authorizedPoints"}),key:"authorizedPoints",dataIndex:"authorizedPoints",render:function(e,a){return U.default.createElement(f.default,{title:(0,I.formatMessage)({id:"oal.common.terminalAssigned/terminalTotal"})},U.default.createElement("span",null,a.authorizedPoints&&a.authorizedPoints.terminalAssigned||0,"/",a.authorizedPoints&&a.authorizedPoints.terminalTotal||0))}},{title:(0,I.formatMessage)({id:"oal.common.phoneNumber"}),key:"phoneNumber",dataIndex:"phoneNumber",render:function(e,a){return U.default.createElement("span",null,a&&a.profile&&a.profile.mobile||"-")}},{title:(0,I.formatMessage)({id:"oal.common.email"}),key:"email",dataIndex:"email",render:function(e,a){return U.default.createElement("span",null,a&&a.profile&&a.profile.email||"-")}},{title:(0,I.formatMessage)({id:"oal.common.handle"}),key:"handle",render:function(a,t){return U.default.createElement(U.Fragment,null,U.default.createElement("a",{onClick:function(){return e.handleUpdateModalVisible(t)}},U.default.createElement(I.FormattedMessage,{id:"oal.common.modify"})),U.default.createElement(c.default,{type:"vertical"}),U.default.createElement("a",{onClick:function(){return e.openAssignModal(t)},disabled:e.props.currentUser._id===t._id},U.default.createElement(I.FormattedMessage,{id:"oal.common.assign"})),U.default.createElement(c.default,{type:"vertical"}),U.default.createElement("a",{onClick:function(){return e.openResetModal(t)}},U.default.createElement(I.FormattedMessage,{id:"oal.user-manage.resetPassword"})),U.default.createElement(c.default,{type:"vertical"}),1===t.state?U.default.createElement("a",{onClick:function(){return e.openDelModal(t)},disabled:e.props.currentUser._id===t._id},U.default.createElement(I.FormattedMessage,{id:"oal.common.disable"})):U.default.createElement("a",{onClick:function(){return e.handleState(1,t._id)}},U.default.createElement(I.FormattedMessage,{id:"oal.common.enable"})))}}]},e.handleState=function(a,t){var n=e.props.dispatch,l=a;n({type:"userManagement/handleState",payload:{userId:t,state:a}}).then(function(a){a&&a.res>0&&(m.default.success((0,I.formatMessage)({id:l?"oal.user-manage.beenEnabled":"oal.user-manage.beenDisabled"})),e.closeDelModal(),e.loadUserList())})},e.loadUserList=function(){var a=e.props.dispatch,t=e.state,n=t.page,l=t.formValues;a({type:"userManagement/fetch",payload:(0,u.default)({},n,l)})},e.deleteUser=function(a){e.handleState(0,a._id)},e.resetPsw=function(a){var t=e.props.dispatch;t({type:"userManagement/resetPsw",payload:{userId:a._id}}).then(function(a){a&&a.res>0&&(m.default.success((0,I.formatMessage)({id:"oal.org.resetSuccessfully"})),e.closeResetModal(),e.loadUserList())})},e.handleSearch=function(){var a=e.props.form;a.validateFields(function(a,t){if(!a){var n=e.state.page;e.setState({page:(0,u.default)({},n,{current:1}),formValues:t,selectedRows:[]},function(){e.loadUserList()})}})},e.handleFormReset=function(){var a=e.props.form;a.resetFields(),a.setFieldsValue({}),e.setState({page:{current:1,pageSize:10},formValues:{},selectedRows:[]},function(){e.loadUserList()})},e.handleUpdateModalVisible=function(a){e.setState({modalVisible:!0,selectedUser:a})},e.toAdd=function(){e.setState({modalVisible:!0})},e.openResetModal=function(a){e.setState({resetVisible:!0,selectedUser:a})},e.openDelModal=function(a){e.setState({delVisible:!0,selectedUser:a})},e.closeAddOrUpdateModal=function(){e.setState({modalVisible:!1,selectedUser:{}})},e.closeResetModal=function(){e.setState({resetVisible:!1,selectedUser:{}})},e.closeDelModal=function(){e.setState({delVisible:!1,selectedUser:{}})},e.submitAddOrUpdate=function(a,t){var n=e.props.dispatch,l=e.state.selectedUser;l&&l._id?n({type:"userManagement/modify",payload:a}).then(function(a){a&&a.res>0&&(m.default.success((0,I.formatMessage)({id:"oal.common.modifySuccessfully"})),e.closeAddOrUpdateModal(),e.loadUserList(),t())}):n({type:"userManagement/add",payload:a}).then(function(a){a&&a.res>0&&(m.default.success((0,I.formatMessage)({id:"oal.face.addSuccessfully"})),e.closeAddOrUpdateModal(),e.loadUserList(),t())})},e.openAssignModal=function(a){e.setState({assignVisible:!0,selectedUser:a})},e.closeAssignModal=function(){e.setState({assignVisible:!1,selectedUser:{}})},e.submitAssignModal=function(a,t){var n=e.props,l=n.dispatch,s=n.currentUser,r=s.authorizedPoints||{},o=r.terminalTotal,i=r.terminalAssigned,d=(a.points,a.diff);l({type:"userManagement/assign",payload:a}).then(function(a){a&&a.res>0&&(m.default.success((0,I.formatMessage)({id:"oal.common.assignSuccessfully"})),e.closeAssignModal(),e.loadUserList(),t&&t(),l({type:"user/modifyAuthorizedPoints",payload:{authorizedPoints:{terminalTotal:o,terminalAssigned:i+d||0}}}))})},e.renderSimpleForm=function(){var a=e.props,t=a.form,n=a.userListLoading,l=t.getFieldDecorator;return U.default.createElement(E.default,{layout:"inline"},U.default.createElement(r.default,{gutter:{md:4,lg:24,xl:48}},U.default.createElement(i.default,{xxl:6,xl:10,lg:10,md:10,sm:24},U.default.createElement(R,{label:(0,I.formatMessage)({id:"oal.user-manage.accountName"})},l("userName")(U.default.createElement(d.default,{placeholder:(0,I.formatMessage)({id:"oal.user-manage.enterAccountNameTips"})})))),U.default.createElement(i.default,{xxl:4,lg:4,md:4,sm:24},U.default.createElement("span",{className:N.default.submitButtons},U.default.createElement(o.default,{onClick:e.handleSearch,type:"primary",htmlType:"submit",loading:n},U.default.createElement(I.FormattedMessage,{id:"oal.face.search"})),U.default.createElement(o.default,{style:{marginLeft:8},loading:n,onClick:e.handleFormReset},U.default.createElement(I.FormattedMessage,{id:"oal.common.reset"}))))))},e.handleSelectRows=function(a){e.setState({selectedRows:a})},e.handleStandardTableChange=function(a){e.setState({page:{current:a.current,pageSize:a.pageSize},selectedRows:[]},function(){e.loadUserList()})},e.user_showTotal=function(e,a){return(0,I.formatMessage)({id:"oal.user-manage.currentToTotal"},{total:e})},e}return(0,p.default)(t,[{key:"componentDidMount",value:function(){this.loadUserList()}},{key:"render",value:function(){var e=this,a=this.props,t=a.userManagement.userList,n=a.userListLoading,l=a.addLoading,r=a.modifyLoading,i=a.handleStateLoading,d=a.currentUser,u=a.resetPswLoading,m=a.assignLoading,c=d&&d.authorizedPoints||{};t&&t.pagination&&(t.pagination.showTotal=this.user_showTotal);var f=this.state,g=f.selectedRows,p=f.modalVisible,b=f.selectedUser,h=f.resetVisible,M=f.delVisible,v=f.assignVisible;return U.default.createElement(x.PageHeaderWrapper,{className:N.default.myPageHeaderWrapper},U.default.createElement(s.default,{bordered:!1},U.default.createElement("div",{className:N.default.tableList},U.default.createElement("div",{className:N.default.tableListForm},this.renderSimpleForm()),U.default.createElement("div",{className:N.default.tableListOperator,style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},U.default.createElement(o.default,{icon:"plus",type:"primary",onClick:function(){return e.toAdd()}},U.default.createElement(I.FormattedMessage,{id:"oal.face.add"})),U.default.createElement("div",null,U.default.createElement("span",null,U.default.createElement("span",{style:{color:"rgba(0, 0, 0, 0.85)"}},U.default.createElement(I.FormattedMessage,{id:"oal.settings.totalAuthorizationPoints"})," :"),U.default.createElement("span",{style:{margin:"0 50px 0 10px"}},c.terminalTotal||0)),U.default.createElement("span",null,U.default.createElement("span",{style:{color:"rgba(0, 0, 0, 0.85)"}},U.default.createElement(I.FormattedMessage,{id:"oal.settings.available"})," :"),U.default.createElement("span",{style:{margin:"0 50px 0 10px"}},c.terminalTotal-c.terminalAssigned||0)),U.default.createElement("span",null,U.default.createElement("span",{style:{color:"rgba(0, 0, 0, 0.85)"}},U.default.createElement(I.FormattedMessage,{id:"oal.settings.assigned"})," :"),U.default.createElement("span",{style:{margin:"0 50px 0 10px"}},c.terminalAssigned||0)))),U.default.createElement(P.default,{rowKey:function(e){return e._id},needRowSelection:!1,selectedRows:g,loading:n,data:t,columns:this.columns(),onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),U.default.createElement(C.default,{confirmLoading:l||r,currentUser:d,visible:p,userBean:b,handleCancel:this.closeAddOrUpdateModal,handleSubmit:this.submitAddOrUpdate}),U.default.createElement(w.default,{visible:h,userBean:b,confirmLoading:u,handleCancel:this.closeResetModal,handleSubmit:this.resetPsw}),U.default.createElement(V.default,{visible:M,userBean:b,confirmLoading:i,handleCancel:this.closeDelModal,handleSubmit:this.deleteUser}),U.default.createElement(F.default,{visible:v,bean:b,currentUserAuthorizedPoints:c,confirmLoading:m,handleCancel:this.closeAssignModal,handleSubmit:this.submitAssignModal}))}}]),t}(U.Component),L=S))||L),z=E.default.create()(_);a.default=z},G4ee:function(e,a,t){"use strict";var n=t("g09b");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("2qtc");var l=n(t("kLXV")),s=n(t("q1tI")),r=t("Y2fQ"),o=function(e){var a=e.userBean,t=e.visible,n=e.handleSubmit,o=e.handleCancel,i=e.confirmLoading;return s.default.createElement(l.default,{destroyOnClose:!0,title:(0,r.formatMessage)({id:"oal.user-manage.disableAccount"}),visible:t,onOk:function(){return n(a)},confirmLoading:i,onCancel:o,maskClosable:!1,okText:(0,r.formatMessage)({id:"oal.common.disable"}),okType:"danger",cancelText:(0,r.formatMessage)({id:"oal.common.cancel"})},s.default.createElement("p",null,s.default.createElement(r.FormattedMessage,{id:"oal.user-manage.deleteAccountConfirm"})))},i=o;a.default=i},HGS4:function(e,a,t){"use strict";var n=t("g09b");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("2qtc");var l=n(t("kLXV"));t("y8nQ");var s=n(t("Vl3Y"));t("5NDa");var r=n(t("5rEg")),o=n(t("q1tI")),i=(t("+n12"),t("Y2fQ")),d={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},u=function(e){var a=e.form,t=e.userBean,n=(e.currentUser,e.visible),u=e.handleSubmit,m=e.confirmLoading,c=e.handleCancel,f=a.getFieldDecorator,g=!(!t||!t._id),p=(0,i.formatMessage)({id:"oal.user-manage.newAccount"});g&&(p=(0,i.formatMessage)({id:"oal.common.modify"}));var b=function(){a.validateFields(function(e,n){if(!e){var l=n;g&&(l.userId=t._id),u(l,function(){a.resetFields()})}})},h=function(e,a,t){var n=/^[\d\*\#\+]{1,14}$/;a&&!n.test(a)&&t((0,i.formatMessage)({id:"oal.common.formatError"})),t()};return o.default.createElement(l.default,{destroyOnClose:!0,title:p,visible:n,onOk:b,confirmLoading:m,onCancel:c,maskClosable:!1},o.default.createElement(s.default,d,o.default.createElement(s.default.Item,{label:(0,i.formatMessage)({id:"oal.user-manage.accountName"})},f("userName",{rules:[{required:!0,message:(0,i.formatMessage)({id:"oal.user-manage.enterAccountNameTips"})},{pattern:/^[a-zA-Z]+$/,message:(0,i.formatMessage)({id:"oal.user-manage.enterUsernameError"})},{max:10,message:(0,i.formatMessage)({id:"oal.common.maxLength"},{num:"10"})}],initialValue:g?t.userName:""})(o.default.createElement(r.default,{placeholder:(0,i.formatMessage)({id:"oal.user-manage.accountName"}),disabled:g}))),o.default.createElement(s.default.Item,{label:(0,i.formatMessage)({id:"oal.common.nickname"})},f("nickName",{rules:[{required:!0,message:(0,i.formatMessage)({id:"oal.user-manage.enterNicknameTips"})},{max:20,message:(0,i.formatMessage)({id:"oal.common.maxLength"},{num:"20"})}],initialValue:g?t.profile&&t.profile.nickName:""})(o.default.createElement(r.default,{placeholder:(0,i.formatMessage)({id:"oal.common.nickname"}),disabled:g}))),o.default.createElement(s.default.Item,{label:(0,i.formatMessage)({id:"oal.common.phoneNumber"})},f("mobile",{rules:[{validator:h}],initialValue:g?t.profile&&t.profile.mobile:""})(o.default.createElement(r.default,{placeholder:(0,i.formatMessage)({id:"oal.common.phoneNumber"})}))),o.default.createElement(s.default.Item,{label:(0,i.formatMessage)({id:"oal.common.emailAddress"})},f("email",{rules:[{type:"email",message:(0,i.formatMessage)({id:"oal.common.formatError"})},{max:80,message:(0,i.formatMessage)({id:"oal.common.maxLength"},{num:"80"})}],initialValue:g?t.profile&&t.profile.email:""})(o.default.createElement(r.default,{placeholder:(0,i.formatMessage)({id:"oal.common.emailAddress"})})))))},m=s.default.create({name:"addOrUpdate"})(u),c=m;a.default=c},TIwi:function(e,a,t){"use strict";var n=t("g09b");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("2qtc");var l=n(t("kLXV")),s=n(t("q1tI")),r=t("Y2fQ"),o=function(e){var a=e.userBean,t=e.visible,n=e.handleSubmit,o=e.handleCancel,i=e.confirmLoading,d=(0,r.formatMessage)({id:"oal.user-manage.resetPassword"});return s.default.createElement(l.default,{destroyOnClose:!0,title:d,visible:t,onOk:function(){return n(a)},onCancel:o,maskClosable:!1,confirmLoading:i,okText:(0,r.formatMessage)({id:"oal.common.reset"}),cancelText:(0,r.formatMessage)({id:"oal.common.cancel"})},s.default.createElement("p",null,s.default.createElement(r.FormattedMessage,{id:"oal.user-manage.resetPasswordConfirm",values:{account:a.userName}})))},i=o;a.default=i}}]);